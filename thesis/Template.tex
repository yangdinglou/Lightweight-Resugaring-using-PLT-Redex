% Copyright (c) 2019 Bochen Tan
% Public domain.
%本模板的宗旨是尽量绿色，不需要附加安装任何东西。
%按照教务部下发的WORD说明文档格式，下简称“说明”
%没有封面和评阅表，这两部分请直接在Cover&ReviewTable.doc中写再输出pdf拼到一起
%doc小改动：封面校徽和文字替换为了高清版本，“题目：”和中文题目对齐，中英文题目分在了表的两行
%doc小改动：插入了两个白页，使得连续打印的时候封面和表格都在奇数页
%正文部分改动：在每一页下方中央加了页码，因为说明中页眉不分奇偶页，所以页码就都在中央吧
%不含自动的参考文献，因为说明中参考文献格式不典型，请手动输入或自行写程序
%在Windows或Linux下渲染出字体更接近说明，Mac OS上字体不太一样
%有警告\headheight is too small，fancyhdr的上距离有点小，似乎问题不大

\documentclass[UTF8,openany,AutoFakeBold,AutoFakeSlant,cs4size]{ctexbook}
%openany 使一章可以从偶数页开始，因为说明中每一章并没有只能从奇数页开始，虽然这是常理
%AutoFakeBold 和 AutoFakeSlant 因为 CJK 里没有真正的加粗和倾斜，如果额外字体则效果更好
%cs4size 因为要求主题是小四号字

\usepackage[a4paper,left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm]{geometry}
%office中正常页边距



\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{amsfonts}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{color}
\usepackage{proof}
\usepackage{float}
\usepackage{algorithm}
\usepackage{algorithmic}

\renewcommand{\algorithmicrequire}{\textbf{输入:}}

\renewcommand{\algorithmicensure}{\textbf{输出:}}

\usepackage{cite}
\newcommand{\upcite}[1]{\textsuperscript{\cite{#1}}} %引用在右上角

\usepackage{hyperref}
\usepackage{gbt7714}

\usepackage{multirow,booktabs,makecell}
\usepackage{graphicx}
\usepackage[font=small,labelsep=space]{caption} %五号，宋体/Time new roman
\renewcommand{\thetable}{\arabic{table}} %表格和图片编号不分章节，直接1，2，3 ...
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\theequation}{\arabic{chapter}.\arabic{equation}} %公式标签 章.公式（均为阿拉伯数字）



\usepackage{tocloft} %自定义目录，说明中没有明确规定，和WORD自动生成目录格式一致

%“全文目录”四个字的格式
\renewcommand\cftbeforetoctitleskip{0pt}
\renewcommand\cftaftertoctitleskip{0pt}
\renewcommand\cfttoctitlefont{\bfseries\heiti\zihao{2}}

\renewcommand\cftchapfont{\heiti\normalsize} %黑体小四
\renewcommand\cftchapdotsep{\cftdotsep} %有点连到页码，点间距不确定，待改
\renewcommand\cftchappagefont{\songti\normalsize} %宋体小四页码
\renewcommand\cftbeforechapskip{0pt}

%1. 第一级 五号宋体，缩进两个字符，页码一致
\renewcommand\cftsecfont{\songti\small}
\renewcommand\cftsecpagefont{\songti\small}
\renewcommand\cftsecaftersnum{.} %一级目录号后加点
\renewcommand\cftsecindent{2em}
\renewcommand\cftbeforesecskip{0pt}

%1.1 第二级 五号宋体，缩进四个字符，页码一致
\renewcommand\cftsubsecfont{\songti\small}
\renewcommand\cftsubsecpagefont{\songti\small}
\renewcommand\cftsubsecindent{4em}
\renewcommand\cftbeforesubsecskip{0pt}

%1.1.1 第二级 五号宋体，缩进四个字符，页码一致
\renewcommand\cftsubsubsecfont{\songti\small}
\renewcommand\cftsubsubsecpagefont{\songti\small}
\renewcommand\cftsubsubsecindent{4em}
\renewcommand\cftbeforesubsubsecskip{0pt}



\usepackage{titlesec}%自定义章节标题
\CTEXsetup[format={\bfseries\center\heiti\zihao{2}},beforeskip=0pt]{chapter}
%第一章  绪论（二号、黑体） beforeskip为上方垂直距离看起来还比说明偏大，待改

\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}
%使目录中有三级标题，即subsubsection

\renewcommand\thesection{\arabic{section}} % 使得不显示章名，只显示节名
\titleformat{\section}
{\raggedright\zihao{3}\bfseries\songti}
{\thesection.\quad}
{0pt}
{}%1. 第一级（三号、宋体/Time new roman、加粗）

\titleformat{\subsection}
{\raggedright\bfseries\zihao{4}\songti}
{\thesubsection\quad}
{0pt}
{}%1.1 第二级（四号，宋体/Time new roman，加粗）

\titleformat{\subsubsection}
{\raggedright\bfseries\zihao{-4}\songti}
{\thesubsubsection\quad}
{0pt}
{}%1.1.1 第三级（小四，宋体/Time new roman，加粗）




% 封面依赖的宏包
\input{CoverHead}
% 评阅表依赖的宏包
\input{ReviewTableHead}


\title{}
\author{}
\date{}
\begin{document}

% 封面中需要修改的内容直接在此处更改即可
\newcommand{\chineseTitle}{一种利用Redex实现重组糖的轻量级方法}
\newcommand{\englishTitle}{A Lightweight Resugaring Method using PLT Redex}
\newcommand{\name}{杨子毅}
\newcommand{\studentID}{1600011063}
\newcommand{\school}{信息科学技术学院}
\newcommand{\major}{软件工程}
\newcommand{\advisor}{胡振江}
% 插入封面
\input{cover}
\clearpage


% 插入导师评阅表
\input{ReviewTable}
\clearpage

\zihao{-4}\songti\linespread{1.5}\selectfont
\linespread{1.5}\selectfont
\chapter*{版权声明}
\setcounter{page}{0}
% 本页不计页码
\thispagestyle{empty}
% 本页无页眉和页脚
任何收存和保管本论文各种版本的单位和个人，未经本论文作者同意，不得将本论文转借他人，亦不得随意复制、抄录、拍照或以任何方式传播。否则，引起有碍作者著作权之问题，将可能承担法律责任。
\clearpage

%版权声明后空白一页，使得摘要从奇数页开始。
%\quad
%\setcounter{page}{0}
% 本页不计页码
%\thispagestyle{empty}
% 本页无页眉和页脚
%\clearpage



\pagestyle{fancy}
\normalsize
\linespread{1.5}\selectfont
%小四号，宋体/Time new roman，1.5倍行距



\chapter*{摘要}

\phantomsection
\addcontentsline{toc}{chapter}{摘要} %手动加入目录
随着计算机科学的普及和程序设计语言的发展，程序设计语言、特别是领域特定语言的应用越来越日常化。语法糖作为实现领域特定语言的一项重要技术在近年来发展火热，相关的研究以及为支持DSL设计特性的的程序设计语言(例如Racket、Scala)都有显著进展显著。

重组糖是一项关于语法糖的研究---将嵌入在内部语言的语法糖表达式执行序列在表面语言（语法糖）上提取出来，以得到在语法糖层面的执行序列（详见\ref{mark:resugaring}）。其目的是为了解决语法糖解糖的单向性，让语法糖表达式的执行过程能表现在语法糖结构上。但现存方法很难处理递归糖、高阶糖等语法糖特性，且对于卫生宏处理很繁琐。

我们基于PLT Redex设计了一个轻量级重组糖算法，简单实现了一套工具并在一些例子上应用进行测试。结果显示我们的轻量级重组糖算法相较于现有重组糖算法可以多处理一些语法糖特性，也更容易处理卫生宏等特性。除此之外，我们的方法在表示语法糖的方式上更加灵活。

%背景 解决什么问题 得到什么结果

\bigskip
\noindent{\bfseries\songti 关键词: 领域特定语言、语法糖、解释器、重写系统 }


\fancypagestyle{plain} %因为latex默认每章第一页是plain所以需要重置一下plain和说明统一
{
	\fancyhf{} %清空

	\fancyhead[RE,RO]{摘要}
	%偶数页右页眉，奇数页右页眉均为“摘要”，及章名\leftmark

	\fancyhead[LE,LO]{北京大学本科生毕业论文}
	%偶数页左页眉，奇数页左页眉均为“北京大学本科生毕业论文”

	\fancyfoot[CO,CE]{~\thepage~}
	%偶数页和奇数页中页脚为页码，从对称考虑，因为每页在说明中都是一样的，不分奇偶

	\renewcommand{\headrulewidth}{0.7pt} %页眉线宽度，可调，不太清楚说明中是多少，待改

	\renewcommand{\footrulewidth}{0pt} %页脚线宽度为0，既没有
}

%默认的风格是fancy，设置于下，用于每章非第一页
\fancyhf{}
\fancyhead[RE,RO]{摘要}
\fancyhead[LE,LO]{北京大学本科生毕业论文}
\fancyfoot[CO,CE]{~\thepage~}
\renewcommand{\headrulewidth}{0.7pt}
\renewcommand{\footrulewidth}{0pt}
\clearpage






\small
\linespread{1.5}\selectfont
%5号，Time new roman，1.5倍行距

\chapter*{\bfseries Abstract}
\phantomsection
\addcontentsline{toc}{chapter}{\bfseries Abstract} %Abstract加粗
With the popularization of computer science and the development of programming languages, the application of programming languages, especially domain-specific languages, is becoming more and more routine. Syntactic sugar, as an important technique for implementing a domain-specific language, has developed fiercely in recent years, and related research and programming languages designing features for DSL(such as Racket, Scala) are making significant progress.

Resugaring is a research on syntactic sugar--lifting the evaluation sequence of syntactic sugar expression embedded in the core language on the surface language (syntactic sugar) to get the sequence at the level of syntactic sugar. (see detail\ref{mark:resugaring}) The purpose of resugaring is to solve the unidirectionality of desugaring the syntactic sugar expression, so that the evaluation sequence of syntactic sugar expression can be expressed in the structure of syntactic sugar. However, the existing methods are difficult to deal with the features of syntactic sugar such as recursive sugar and high-order sugar, and are very cumbersome for hygienic macro processing.

We designed a lightweight resugaring algorithm based on PLT Redex, simply implemented a set of tools and tested on some examples. The results show that our lightweight resugaring algorithm can handle more syntactic sugar features than existing resugaring algorithms, also handle features like hygienic macro more simply. In addition, our method is more flexible in the way of representing syntactic sugar.


\bigskip
\noindent

{\bfseries Key Words: Domain-specific language, Syntactic sugar, Interpreter, Rewriting system }



\fancypagestyle{plain}
{
	\fancyhf{}
	\fancyhead[RE,RO]{Abstract}
	\fancyhead[LE,LO]{北京大学本科生毕业论文}
	\fancyfoot[CO,CE]{~\thepage~}
	\renewcommand{\headrulewidth}{0.7pt}
	\renewcommand{\footrulewidth}{0pt}
}
\fancyhf{}
\fancyhead[RE,RO]{Abstract}
\fancyhead[LE,LO]{北京大学本科生毕业论文}
\fancyfoot[CO,CE]{~\thepage~}
\renewcommand{\headrulewidth}{0.7pt}
\renewcommand{\footrulewidth}{0pt}
\clearpage





\fancypagestyle{plain}
{
	\fancyhf{}
	\fancyhead[RE,RO]{全文目录}
	\fancyhead[LE,LO]{北京大学本科生毕业论文}
	\fancyfoot[CO,CE]{~\thepage~}
	\renewcommand{\headrulewidth}{0.7pt}
	\renewcommand{\footrulewidth}{0pt}
}
\fancyhf{}
\fancyhead[RE,RO]{全文目录}
\fancyhead[LE,LO]{北京大学本科生毕业论文}
\fancyfoot[CO,CE]{~\thepage~}
\renewcommand{\headrulewidth}{0.7pt}
\renewcommand{\footrulewidth}{0pt}
\renewcommand{\contentsname}{\centerline{全文目录}}
\phantomsection
\tableofcontents
\addcontentsline{toc}{chapter}{全文目录}
\clearpage





\normalsize
\linespread{1.5}\selectfont
%正文，小四号，中文宋体，英文Time new roman，1.5倍行距
\fancypagestyle{plain}
{
	\fancyhf{}
	\fancyhead[RE,RO]{\leftmark}
	\fancyhead[LE,LO]{北京大学本科生毕业论文}
	\fancyfoot[CO,CE]{~\thepage~}
	\renewcommand{\headrulewidth}{0.7pt}
	\renewcommand{\footrulewidth}{0pt}
}
\fancyhf{}
\fancyhead[RE,RO]{\leftmark}
\fancyhead[LE,LO]{北京大学本科生毕业论文}
\fancyfoot[CO,CE]{~\thepage~}
\renewcommand{\headrulewidth}{0.7pt}
\renewcommand{\footrulewidth}{0pt}



%正文，五号，中文宋体，英文Time new roman，1倍行距
\input{chapter/introduction}
\input{chapter/background}
\input{chapter/algorithm}
\input{chapter/implement}
\input{chapter/evaluation}
\input{chapter/conclusion}


\clearpage
\phantomsection
\addcontentsline{toc}{chapter}{参考文献}
\small
\bibliographystyle{gbt7714-numerical}

\bibliography{ref}


\linespread{1}\selectfont
\normalsize
%小四号，中文宋体，英文Time new roman，1倍行距
\chapter*{本科期间的主要工作和成果}

\noindent 本科期间参加的主要科研项目

\noindent 本研基金
\begin{enumerate}
	\item 校长基金. 校长基金（理）. 熊英飞. 1年
\end{enumerate}

\noindent 各种科研项目
\begin{enumerate}
	\item TV Backscatter. 课程项目
	\item Static Analysis using Inductive Logic Programming. 本科生科研
	\item DryadSynth Solver. 暑期科研
\end{enumerate}



\addcontentsline{toc}{chapter}{本科期间的主要工作和成果}
\fancypagestyle{plain}
{
	\fancyhf{}
	\fancyhead[RE,RO]{本科期间的主要工作和成果}
	\fancyhead[LE,LO]{北京大学本科生毕业论文}
	\fancyfoot[CO,CE]{~\thepage~}
	\renewcommand{\headrulewidth}{0.7pt}
	\renewcommand{\footrulewidth}{0pt}
}
\fancyhf{}
\fancyhead[RE,RO]{本科期间的主要工作和成果}
\fancyhead[LE,LO]{北京大学本科生毕业论文}
\fancyfoot[CO,CE]{~\thepage~}
\renewcommand{\headrulewidth}{0.7pt}
\renewcommand{\footrulewidth}{0pt}
\clearpage





\linespread{1.5}\selectfont
\normalsize
%正文，小四号，中文宋体，英文Time new roman，1.5倍行距
\chapter*{致谢}
感谢胡振江老师对我毕设工作期间的指导。前期和胡老师的对DSL项目的多次探讨激发了本文的初步想法，并在胡老师的指引下对工作不断完善。胡老师对我研究方法、思考方式、写作等方面的指导都受益匪浅。尽管有时无心学习进度缓慢，胡老师依然对有限的进展予以肯定，让我不好意思继续拖延，最终能够让标志着本科结束的工作有一个令自己满意的结果。

感谢熊英飞老师对我本科生科研期间及之后的指导。熊老师是我正式步入科研的引路人，且对我很多学习习惯的培养、和我对工作生活态度的探讨对我帮助很大。并且毕设是熊老师推荐我和胡老师做的。

感谢17级本科生关智超同学。关智超同学在今年3月加入胡老师和我的项目讨论，并在之后对我论文写作方面提出宝贵建议。特别是本文中“Resugaring”一词的中文翻译---重组糖是关智超同学提出的。

感谢我的舍友们。尽管由于疫情原因，本文工作及写作大部分时间不是在宿舍进行的，但他们三个人努力学习，创造宿舍良好的学习环境，让不爱学习的我羞愧难当，没有完全不学习；并且宿舍的卫生条件、生活气氛等等都十分不错，让我在本科三年半的时间里生活愉快。

感谢女朋友周宇航同学。周宇航同学在我整个本科期间督促我学习、陪我玩、帮助我、支持我。毕设工作的代码和论文经常是在夜间进行，她和她的猫经常熬夜陪我。

感谢父母和其他家人。他们一直在支持我的各种选择，并且在物质上和精神上帮助我。父母对我要求极低，导致我有一个自认为不错的性格，以至于快乐的生活。

感谢本科期间遇见的所有老师和同学及其他人士、动植物和其他事物。这些人和事构成了我本科期间的无数的碎片化回忆。


\addcontentsline{toc}{chapter}{致谢}
\fancypagestyle{plain}
{
	\fancyhf{}
	\fancyhead[RE,RO]{致谢}
	\fancyhead[LE,LO]{北京大学本科生毕业论文}
	\fancyfoot[CO,CE]{~\thepage~}
	\renewcommand{\headrulewidth}{0.7pt}
	\renewcommand{\footrulewidth}{0pt}
}
\fancyhf{}
\fancyhead[RE,RO]{致谢}
\fancyhead[LE,LO]{北京大学本科生毕业论文}
\fancyfoot[CO,CE]{~\thepage~}
\renewcommand{\headrulewidth}{0.7pt}
\renewcommand{\footrulewidth}{0pt}





\end{document}
